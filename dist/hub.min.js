!function(n){"function"==typeof define&&define.amd?define(n):n()}((function(){"use strict";!function(n){var e=window["bridge_hub_<name>"];if(null!=e)return e;e={},window["bridge_hub_<name>"]=e;var r=[],t=function(){try{if(null!=window[n].postMessage)return function(e){try{return window[n].postMessage(JSON.stringify(e)),!0}catch(n){return!1}}}catch(e){try{if(null!=window.webkit.messageHandlers[n].postMessage)return function(e){try{return window.webkit.messageHandlers[n].postMessage(JSON.stringify(e)),!0}catch(n){return!1}}}catch(e){return function(e){try{r.push(JSON.stringify(e));var t=document.createElement("iframe");return t.style.display="none",t.src="https://bridge/query?name="+encodeURIComponent(n),document.documentElement.appendChild(t),setTimeout((function(){document.documentElement.removeChild(t)}),1),!0}catch(n){return!1}}}}}(),i={};e.query=function(){var n=JSON.stringify(r);return r.splice(0,r.length),n},e.transmit=function(e){return function(e){var r=e.to,t=i[r];if(null==t)return!1;var o={};o[n]=e,t.postMessage(o,"*")}(JSON.parse(e)),!0},window.addEventListener("message",(function(e){var r=e.source,o=e.data;try{var u=o[n];if(null==u)return;var s=u.from,a=void 0===s?null:s,c=u.to,d=void 0===c?null:c,f=u.type,l=void 0===f?null:f;if(d!==n)return;if(null==a)throw new Error("from == null");var m=i[a];if("disconnect"===l){if(null==m)return;if(m!==r)throw new Error("bridge id mismatch");delete i[a]}else if("connect"===l){if(m===r)return;if(null!=m)throw new Error("bridge id mismatch");i[a]=r}else if(m!==r)throw new Error("bridge id mismatch");t(u)}catch(n){throw n}}));var o,u=function(){for(var e in i){i[e];t({from:e,to:n,type:"disconnect"})}(function(n){throw new Error('"'+n+'" is read-only')})("bridges"),i={}};window.addEventListener("unload",(function(){u()})),o={"<name>":{type:"load"}},function n(e,r){e.postMessage(r,"*");for(var t=e.frames,i=0,o=t.length;i<o;i++)n(t[i])}(window,o)}("<name>")}));
